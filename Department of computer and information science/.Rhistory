library(bnlearn)
library(dplyr)
library(stringr)
separator <- ';'
df <- read.csv("E:/Dars/Liu Thesis/Reports/Causality Analysis/Department of Media and Information Technology/MIT.csv")
keyword_column <- 'Keywords'
A_num <- 2
# Compute co-occurrences
df <- df %>%
select(PID, Year, Keywords) %>%
filter(!is.na(.data[[keyword_column]]), .data[[keyword_column]] != "")
IDA <- read.csv("E:/Dars/Liu Thesis/Reports/Causality Analysis/Department of computer and information science/IDA.csv")
View(IDA)
df <- read.csv("E:/Dars/Liu Thesis/Reports/Causality Analysis/Department of computer and information science/IDA.csv")
keyword_column <- 'Keywords'
A_num <- 2
# Compute co-occurrences
df <- df %>%
select(PID, Year, Keywords) %>%
filter(!is.na(.data[[keyword_column]]), .data[[keyword_column]] != "")
# Convert lists of keywords to tuples
df[[keyword_column]] <- lapply(df[[keyword_column]], function(x) {
keywords <- unlist(strsplit(tolower(x), separator))
trimws(keywords)  # Remove leading and trailing whitespaces
})
# Compute co-occurrences
co_occurrences <- table(unlist(lapply(df[[keyword_column]], function(x) {
if(length(x) >= 2) {
combn(sort(x), 2, paste, collapse = "::")
} else {
character(0)  # Return empty character vector if less than 2 keywords
}
})))
co_occurrences <- sort(co_occurrences, decreasing = TRUE)
# Extract edges from co-occurrences
edges <- as.data.frame(matrix(names(co_occurrences), ncol = 1, byrow = TRUE))
# Create a Bayesian Network from the co-occurrences
bn <- empty.graph(nodes = unique(unlist(df[[keyword_column]])))
# Use lapply to iterate over edges
lapply(1:nrow(edges), function(i) {
edge <- unlist(strsplit(as.character(edges[i, ]), "::"))  # Corrected parsing of edge
if (length(edge) == 2 && edge[1] != edge[2]) {  # Ensure from and to are different
bn <<- set.arc(bn, from = edge[1], to = edge[2])
}
})
